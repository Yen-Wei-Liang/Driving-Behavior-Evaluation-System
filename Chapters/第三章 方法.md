### [回目錄](../ReadMe.md)
# 第三章 方法

<br>

## 3.1 資料集建置  <a id="31"></a>

<br>

**本研究針對模型的訓練和驗證建立了兩個不同的資料集。首先，我們收集了一個位於學區附近，環境中車流量較少的資料集作為訓練資料集。並考量機車行駛的大部分時間，駕駛者主要都是進行直行和怠速（等紅燈）的動作。為了避免模型在預測時出現盲猜直行和怠速的情況，我們設計了六種常見的機車駕駛行為，包括直行、左轉、右轉、迴轉、待轉和怠速。同時，我們在資料集的採集路線中刻意減少了直線和怠速狀態的數量，也因這安全疑慮，故我們選擇在學區附近車流量較少的地點，進行資料收集。**

<br>

**此外，我們還收集了在夜市穿梭的資料集作為驗證集。夜市的車流量和人流量較多，環境與學區附近變得極為複雜，需要特別注意的是，在資料集中的迴轉和待轉狀態是根據本國法規特意採集的。如果研究對象是右駕國家，可以考慮移除這兩個狀態。**


### 3.1.1 目標與說明  <a id="311"></a>

<br>

**我們的主要目標是利用蒐集的資料集來改善機車駕駛行為的預測能力。為了保護使用者隱私，我們選擇不使用影像資訊，而是以機車的ECU和IMU資料作為主要的特徵資訊。我們希望透過這些資料的分析和預測，能夠提供更準確和有效的機車駕駛行為評估方法，並促進機車行駛安全和交通管理的發展**




### 3.1.2 資料收集方法  <a id="312"></a>

<br>

**為了蒐集資料集，我們使用了Android平板來收集IMU資料。具體而言，我們將Android平板放置於機車後車箱中（車身中央），以獲取機車行駛時的加速度、角速度等數據。這樣的位置選擇可以減少來自不同位置的噪音干擾，同時我們使用Gopro攝影機來記錄整個採樣過程。這一方面可以方便後續對資料進行標記和驗證預測效果的準確度，另一方面也有助於對齊ECU和IMU資料。**

<br>

**此外，為了提高資料集的可信度，我們也記錄了GPS訊號和行駛路線的資訊。這些資料將有助於進一步分析機車駕駛行為與地理位置之間的關聯性，並為相關研究提供更多有價值的資源。**

<br>

**該資料集總共包含 27,577 個樣本點，其中包含9條直線(1,305個樣本點)、20條怠速(8,900個樣本點)、10條左轉(1,350個樣本點)、10條右轉(1,850個樣本點)、20條待轉(2,500個樣本點)、9條迴轉(1,035個樣本點)。**

<br>

**實驗的部分Downsample至每秒頻率6，並將不重疊將資料分成訓練集與測試集資訊如下：**
**該資料集總共包含 5,516 個樣本點**

<br>

**訓練集**
**5條直線(平均:29個樣本點、標準差:7個樣本點)**
**12條怠速(平均:78個樣本點、標準差:48個樣本點)**
**6條左轉(平均:26個樣本點、標準差:2個樣本點)**
**6條右轉(平均:31個樣本點、標準差:3個樣本點)**
**14條待轉(平均:23個樣本點、標準差:3個樣本點)**
**6條迴轉(平均:25個樣本點、標準差:2個樣本點)。**

<br>

**測試集**
**5條直線(平均:28個樣本點、標準差:2個樣本點)**
**12條怠速(平均:105個樣本點、標準差:68個樣本點)**
**6條左轉(平均:29個樣本點、標準差:4個樣本點)**
**6條右轉(平均:45個樣本點、標準差:4個樣本點)**
**14條待轉(平均:30個樣本點、標準差:3個樣本點)**
**6條迴轉(平均:20個樣本點、標準差:1個樣本點)。**

<br>

**對應Github上的資料**
**學區所對應GPS資料  :0417_GPS.csv**
**學區所對應資料集   :Train_DataSet_Rotation_Init_Normalized_F6_10_Cluster.csv**
**學區所對應資料集   :Test_DataSet_Rotation_Init_Normalized_F6_10_Cluster.csv**
**夜市所對應GPS資料集:0530_GPS.csv**
**夜市所對應資料集:Verification_DataSet_Rotation_Init_Normalized_F6_10_PredictCluster.csv**

![Place_The_Luggage_In_The_Trunk](https://github.com/Yen-Wei-Liang/Driving-Behavior-Evaluation-System/assets/127264553/5102ba59-28f1-4ef3-a53b-0d9a0746e240)


**圖 1 ECU接收器與IMU感測器放置位子**


### 3.1.3 資料集蒐整流程  <a id="313"></a>

<br>

**準備Android平板和Gopro攝影機，確保它們正常運作並具備足夠的電量。
將Android平板放置於機車後車箱中心位置，以確保資料的準確性和一致性。**

<br>

**啟動Android平板上的IMU資料記錄程式，開始收集加速度、角速度等數據。
同時使用Gopro攝影機記錄整個採樣過程，以便後續資料標記和驗證。
在收集過程中同步記錄GPS訊號和行駛路線的資訊。完成資料收集後，對資料進行儲存和整理，確保資料的可讀性和可用性。
這樣的資料收集方法能夠提供充分且多樣化的機車駕駛行為資料，有助於進一步的分析和研究。**

![流程圖](https://github.com/Yen-Wei-Liang/Driving-Behavior-Evaluation-System/assets/127264553/cf53dc96-9baf-4711-ba0d-f378be8ac3d9)

**圖2 資料集蒐整流程**


### 3.1.4 資料屬性和特徵  <a id="314"></a>

<br>

**本資料集包含了多個變量和特徵，提供了詳細的機車駕駛行為資訊。具體而言，資料集中包含了當前時間、XYZ角速度、XYZ加速度、XYZ角度、TPS開度、引擎轉速等共計61項特徵。IMU資料已經經過校正並進行了min-max正規化，將數值映射至[0,1]之間，以確保資料的一致性和可用性。**


### 3.1.5 資料集的規模和範圍  <a id="315"></a>

<br>

#### 3.1.5.1 訓練資料集  <a id="3151"></a>

<br>

**訓練資料集的採集時間為2023年4月17日下午14時16分開始，總共採集了26分鐘，共計27578筆資料。資料集中包含了每個時間點的樣本數據，以及該時間範圍內的GPS詳細資訊（如經度、緯度、海拔、時間戳和速度等）。此外，資料集的採集時間選擇在非尖峰時刻的14:16，以確保資料的可靠性和一致性。**


![採集資料集當下車流_2](https://github.com/Yen-Wei-Liang/Driving-Behavior-Evaluation-System/assets/127264553/08035579-a54b-4d4f-a095-f96afb620a29)

**圖3 車流量較少資料集的實體環境**

![學區取樣地圖-1](https://github.com/Yen-Wei-Liang/Driving-Behavior-Evaluation-System/assets/127264553/70cf1b6b-34b2-405d-ae9f-1482a667ce50)

**圖4 學區資料採集路線(左)，六類動作採集位置(右)，怠速則為機車停紅燈時**


#### 3.1.5.2 驗證資料集   <a id="3152"></a>

<br>

**驗證資料集的採集時間為2023年5月30日下午18時33分開始，總共採集了27分鐘，共計28009筆資料。資料集中包含了每個時間點的樣本數據，以及該時間範圍內的GPS詳細資訊（如經度、緯度、海拔、時間戳和速度等）。此外，資料集的採集時間選擇在晚餐尖峰時刻的18:33，以確保環境資料的亂度與複雜度。**


![採集資料集夜市](https://github.com/Yen-Wei-Liang/Driving-Behavior-Evaluation-System/assets/127264553/561c62bd-fff1-459a-b1f9-b7dfea10d156)
**圖5 車流量較多資料集的實體環境**

![忠孝夜市採集-2](https://github.com/Yen-Wei-Liang/Driving-Behavior-Evaluation-System/assets/127264553/270a88b0-5c7e-422c-99bb-4685119d9d21)
**圖6 夜市資料採集路線(左)，六類動作採集位置(右)，怠速則為機車停紅燈時**



### 3.1.6 資料集的獨特性和價值  <a id="316"></a>

<br>

**這份資料集的獨特之處在於結合了機車的ECU和IMU資料，並提高了採集頻率。相較於現有的資料集，我們的資料集不僅提供了更豐富的特徵資訊，還包含了複雜環境下的駕駛情境。這樣的資料集填補了當前研究領域中在機車駕駛行為預測方面的缺口，並為相關研究提供了更具價值的資源和新的研究方向。**



### 3.1.7 資料集標記方法  <a id="317"></a>

<br>

**我們使用剪輯軟體Adobe Premiere將GoPro錄製的影片導入。由於剪輯軟體設定為24幀數（25進制），ECU採集的最小時間單位為0.01秒（1.00進制），因此，每一幀對應於ECU採集時間間隔為0.25秒。在剪輯軟體中，我們使用了標記功能。我們將標記的時間表示為分鐘:秒數:幀數，並與影片中ECU開始採集的時間標記進行相減，從而得到時間差(分鐘:秒數:幀數)。然後，我們將中間的差距轉換為秒數（從ECU開始採集到當前狀態經過的時間），從而準確判斷我在影片標記中的實際時間。在與資料集對應的幀數時進行標記，以盡量減小誤差。**

**這樣的標記方法能夠準確地將影片中的標記時間與資料集中的時間對應起來，並最大程度地減小誤差。**

![Adobe](https://github.com/Yen-Wei-Liang/Driving-Behavior-Evaluation-System/assets/127264553/80562d5b-1134-4c35-9491-d6fa249eb19a)
**圖 7 剪輯軟體Adobe Premiere 紅色框為剪輯軟體中時間，橘色框為影片中動作標記**



### 3.1.8 困難標記的挑戰  <a id="318"></a>

<br>

**在資料集的介紹部分，使用一個獨立的段落來描述標記的困難性。講述標記的挑戰、複雜性和主觀性，並解釋為什麼無法準確標記當下的行為（例如左右轉）。**

<br>

解決方法:

<br>

**1. 錄製影片: 在收集資料時同時錄製騎車過程的影片。這樣一來，即使無法準確標記行為，後續的分析者仍然可以參考影片內容來進行更好的判斷。**

**2. 多人標記: 利用多人參與標記資料，並要求他們獨立地觀察資料與標記行為。這樣做可以減輕單一觀察者的主觀偏差，並獲得多個觀點，依大家的標記重疊性來提高標記的準確性。**

**3. 標記不確定性: 在標記過程中，我們引入一個額外的標籤來表示不確定的情況。例如，當觀察者無法確定行為時，可以標記為「Transition」或直接空白讓資料顯示NaN。這有助於區分確定的行為和不確定的行為。**

**4. 演算法驗證: 我們先標記一部份資料當作baseline，並將預測出來的結果與人工標記進行比較。這樣一來，就可以簡易量化準確性，但我們認為在Transition的部分不應該屬於任何動作，因為它非常模糊可能介於兩種動作之間，故我們提出一種新的演算法來計算預測行為的分數。**

**5. 開放資料集: 我們將分享資料集，並提供清晰的說明和文檔，將解釋標記的困難之處。希望能幫助所有使用者理解資料集的局限性，並可能激發更多的研究與討論。**

### 3.1.9 資料集的可用性和分享  <a id="319"></a>

<br>

**我們準備將這份資料集公開分享給其他研究人員，以促進相關領域的研究和發展。我們將提供資料集的存取方式和共享方式，以確保其他研究人員能夠方便地獲取和使用這份資料集。這將有助於促進知識交流和合作，並推動機車駕駛行為預測研究的進展。**

## 3.2 RideTrack演算法  <a id="32"></a>

<br>

**為了提高標記效率和準確性，我們提出了一種基於分群序列的半自動標記方法，以克服目前人工標記方式的耗時和效率低下的問題，並解決不同人員標記之間存在的差異性，從而間接提升標記結果的準確性。本方法結合了分群分析和機器學習技術的優勢。**

**首先，我們使用了Silhouette Score、Calinski-Harabasz Index、Davies-Bouldin Index、Elbow Method等算法，通過評估不同分群數量（即動作元素數量）的性能指標，以找尋最佳分群數量。這樣可以確保我們在後續分群過程中選擇了最適合的動作元素數量，從而提高駕駛行為特徵的提取效果。**

**接著，我們使用K-means分群算法對資料進行分群。通過將資料劃分為不同的群集，我們能夠捕捉到不同駕駛行為的特徵，並將其應用於後續的分類任務。這樣的分群方式不僅提高了效率，還能夠減少人工標記的主觀性和差異性。**

**在分群後，我們利用這些動作元素序列來訓練VLMM模型，我們建立一個能夠自動識別駕駛行為的模型，通過訓練好的模型進行預測，我們可以得到一個自動化的標記結果。**

**我們與人工標記結果進行比較，平均重疊率達到了約80%。相較於傳統的閾值設定和分類方法，本方法在標記效率和準確性方面都取得了顯著的提升。這一技術的引入不僅可以節省大量的標記時間和成本，還能夠確保標記結果的一致性和準確性，從而為相關研究和應用提供了更可靠的基礎。**

**這種基於分群序列的半自動標記方法為駕駛行為分析和研究領域帶來了重要的貢獻，並在標記效率和準確性方面取得了顯著的突破。**
