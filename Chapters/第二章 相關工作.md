### [回目錄](../ReadMe.md)
# 第二章 相關工作 

<br>

## 2.1 駕駛行為辨識 {#21}

<br>

**在駕駛行為研究領域中，大部分的文獻都專注於駕駛風格識別、攻擊性行為檢測或分心行為辨識等方面。相較之下，對於機車駕駛行為的識別研究相對較少，即使存在也僅限於簡單的左右轉和加減速等基本動作。因此，本研究專注於機車駕駛行為的辨識，並且根據左駕國家的特點，將機車駕駛行為分為直行、左轉、右轉、迴轉、待轉和待速等六種類型。**

<br>

**隨著科技的進步，人們對於個人隱私的關注也日益提高。近年來，蘋果公司在隱私保護方面提出了許多改革和創新服務。然而，在駕駛行為研究中，大多數方法都基於影像作為行為辨識的基礎。然而，影像計算通常具有較高的計算複雜度，且影像資料往往與個人隱私存在衝突。因此，本研究旨在探索一種不使用影像資料的方法，實現對機車駕駛行為的辨識。**

<br>

**透過本研究，我們期望能夠為駕駛行為辨識領域帶來新的視角和方法，同時推動隱私保護和駕駛安全的發展。我們的工作將有助於促進機車駕駛行為研究的進步，並為社會提供更智能、更安全的交通解決方案。**

<br>





## 2.2 K-means分群與最佳分群數演算法原理與應用 {#22}

<br>

### 2.2.1 K-means分群演算法 {./Chapters/第二章%20相關工作.md#駕駛行為辨識}

<br> 


**K-means是一種常用的聚類算法，用於將資料劃分為預先指定的K個聚類。該算法通過最小化每個樣本與其所屬聚類中心之間的平方距離來實現。**

<br>

**步驟：**

<br>

**1. 選擇K值：首先，選擇要劃分的聚類數量K。**

**2. 初始化聚類中心：隨機從數據集中選擇K個樣本作為初始的聚類中心。**

**3. 分配樣本到聚類：對於每個樣本，計算它與每個聚類中心之間的距離，並將該樣本劃分到距離最近的聚類中。**

**4. 更新聚類中心：對於每個聚類，計算該聚類中所有樣本的平均值，並將該平均值作為新的聚類中心。**

**5. 重複步驟3和4：重複執行步驟3和4，直到聚類中心不再變化，或達到最大迭代次數。**

**6. 獲取最終聚類結果：最終的聚類結果由聚類中心和每個樣本的分配組成。**

<br>

**公式：**

<br>

**1. 計算兩個樣本之間的歐氏距離：**

   ![equation](https://latex.codecogs.com/png.image?\dpi{120}&space;d(x,&space;y)&space;=&space;\sqrt{\sum_{i=1}^{n}&space;(x_i&space;-&space;y_i)^2})

   **其中，`x`和`y`是兩個樣本，`n`是特徵的數量。**

**2. 計算樣本到聚類中心的平方距離：**

   ![equation](https://latex.codecogs.com/png.image?\dpi{120}&space;d(x,&space;c)&space;=&space;\sum_{i=1}^{n}&space;(x_i&space;-&space;c_i)^2)

   **其中，`x`是樣本，`c`是聚類中心，`n`是特徵的數量。**

<br> 

### 2.2.2 Silhouette Score {#222}

<br> 

**Silhouette Score是一種用於評估聚類算法效果的指標，該指標結合了聚類內部的緊密度和聚類之間的分離度，提供了一個綜合的聚類結果評估。**

<br>

**步驟：**

<br>

**1. 對數據進行聚類：首先，使用所選的聚類算法（例如K-means）將數據劃分為不同的聚類。**

**2. 計算每個樣本的內部距離（a）：對於每個樣本，計算它與同一聚類中所有其他樣本的平均距離，這被稱為內部距離。**

**3. 計算每個樣本的分離度（b）：對於每個樣本，計算它與最接近的其他聚類的所有樣本的平均距離，這被稱為分離度。**

**4. 計算Silhouette Score：對於每個樣本，使用以下公式計算Silhouette Score：**

$$
silhouette\_score = \frac{b - a}{max(a, b)}
$$

**其中，`a`是樣本的內部距離，`b`是樣本的分離度。**

**5. 計算平均Silhouette Score：將所有樣本的Silhouette Score加總，然後除以樣本數，得到平均Silhouette Score。**

**6. 解釋Silhouette Score：Silhouette Score的範圍在-1到1之間。接近1表示樣本被正確地劃分到相應的聚類中並與其他聚類分離開來。接近-1表示樣本被錯誤地劃分，而且更適合劃分到其他聚類中。接近0表示樣本在不同聚類之間的邊界上。**

<br>

### 2.2.3 Calinski-Harabasz Index {#223}

<br>

**Calinski-Harabasz Index是一種用於評估聚類算法效果的指標，該指標結合了聚類內部的緊密度和聚類之間的分離度，提供了對聚類結果的定量評價。**

<br>

**步驟：**

<br>

**1. 對數據進行聚類：首先，使用所選的聚類算法（例如K-means）將數據劃分為不同的聚類。**

**2. 計算群內平方和（WSS）：對於每個聚類，計算聚類內部所有樣本與該聚類中心之間的平方距離，然後將這些距離加總，得到該聚類的群內平方和。**

**3. 計算群間平方和（BSS）：對於每個聚類，計算聚類中心與整個數據集的中心之間的平方距離，然後將這些距離乘以該聚類的樣本數，再將這些乘積加總，得到該聚類的群間平方和。**

**4. 計算Calinski-Harabasz Index：使用以下公式計算Calinski-Harabasz Index：**

![equation](https://latex.codecogs.com/png.image?\dpi{120}&space;CH&space;=&space;\frac{BSS/(k-1)}{WSS/(n-k)})


**其中，`BSS`是群間平方和，`WSS`是群內平方和，`k`是聚類的數量，`n`是樣本的總數。**

**5. 解釋Calinski-Harabasz Index：Calinski-Harabasz Index的值越大，表示聚類結果的緊密度越高、聚類之間的分離度越好。**

<br>

### 2.2.4 Davies-Bouldin Index {#224}

<br>

**Davies-Bouldin Index是一種用於評估聚類算法效果的指標，該指標結合了聚類內部的緊密度和聚類之間的分離度，提供了對聚類結果的定量評價。**

<br>

**步驟：**

<br>

**1. 對數據進行聚類：首先，使用所選的聚類算法（例如K-means）將數據劃分為不同的聚類。**

**2. 計算聚類內部平均距離（CI）：對於每個聚類，計算該聚類中每對樣本之間的平均距離，然後計算這些平均距離的平均值，得到聚類內部平均距離。**

**3. 計算聚類中心之間的距離（MCD）：對於每對不同的聚類，計算它們的中心之間的距離。**

**4. 計算聚類分離度（SI）：對於每個聚類，選擇最適合的聚類作為參照聚類，計算參照聚類的聚類內部平均距離和目標聚類中心之間的距離。**

**5. 計算Davies-Bouldin Index：使用以下公式計算Davies-Bouldin Index：**

![equation](https://latex.codecogs.com/png.image?\dpi{120}&space;DBI&space;=&space;\frac{1}{k}&space;\sum_{i=1}^{k}&space;\max_{j\neq&space;i}\left(\frac{CI_i&plus;CI_j}{MCD_{ij}}\right))

**其中，`k`是聚類的數量，`CI_i`是第`i`個聚類的聚類內部平均距離，`MCD_{ij}`是第`i`個聚類和第`j`個聚類中心之間的距離。**

**6. 解釋Davies-Bouldin Index：Davies-Bouldin Index的值越小，表示聚類結果的緊密度越高、聚類之間的分離度越好。**

<br>


### 2.2.5 Elbow Method {#225}

<br>

**Elbow Method是一種用於選擇K-means聚類算法中最佳聚類數量的方法。該方法通過繪製不同聚類數量對應的成本函數值（例如，SSE）並觀察曲線的彎曲程度來選擇合適的聚類數。**

<br>

**步驟：**

<br>

**1. 選擇K值範圍：首先，選擇一個K值的範圍，例如從2到10。**

**2. 對於每個K值，執行K-means算法：對於選定的每個K值，使用K-means算法對數據進行聚類，並計算相應的成本函數值（例如，SSE）。**

**3. 繪製成本函數值與K值的關係圖：將K值作為X軸，成本函數值作為Y軸，繪製一個折線圖來表示不同K值對應的成本函數值。**

**4. 分析圖形並找到彎曲點：觀察成本函數值與K值的關係圖，找到圖形彎曲的位置。彎曲點是曲線開始平緩下降的位置，表示增加更多的聚類數不再顯著降低成本。**

**5. 選擇最佳K值：根據Elbow Method，選擇彎曲點對應的K值作為最佳聚類數。**

<br>


### 2.3 可變階馬爾可夫模型 (VLMM) {#23}

<br>


**Variable Length Markov Model（VLMM）是一種機率模型，用於建模具有可變長度的序列數據。VLMM在序列數據的建模中廣泛應用，例如語言模型、基因序列分析等。**

<br>

**步驟：**

<br>

**1. 確定VLMM的參數：首先，確定VLMM的參數，包括狀態集合、遷移機率和發射機率。狀態集合表示VLMM的可能狀態，遷移機率表示從一個狀態轉移到另一個狀態的機率，發射機率表示在每個狀態生成觀測值的機率。**

**2. 構建VLMM的狀態轉移圖：根據狀態集合和遷移機率，構建VLMM的狀態轉移圖。狀態轉移圖表示VLMM中狀態之間的轉移關係和對應的遷移機率。**

**3. 學習VLMM的參數：使用訓練數據學習VLMM的參數。通過統計訓練數據中狀態的轉移和觀測值的生成，估計遷移機率和發射機率的值。常用的方法包括最大概似估計（MLE）和期望最大化（EM）算法。**

**4. 預測和生成序列：根據已學習的VLMM參數，可以用於預測和生成新的序列。通過根據當前狀態的發射機率生成觀測值，並根據遷移機率轉移到下一個狀態，從而生成新的序列。**

<br>

**公式：**

<br>

**1. 狀態轉移機率（Transition Probability）：表示從狀態i轉移到狀態j的機率。**

 ![equation](https://latex.codecogs.com/png.image?\dpi{120}&space;P(j|&space;i)&space;=&space;P(q_t&space;=&space;j&space;|&space;q_{t-1}&space;=&space;i))

**其中，`P(j|i)`表示從狀態i轉移到狀態j的機率，`q_t`表示在時間t的狀態，`q_{t-1}`表示在時間t-1的狀態。**

**2. 發射機率（Emission Probability）：表示在每個狀態下生成觀測值的機率。**

![equation](https://latex.codecogs.com/png.image?\dpi{120}&space;P(x_t|&space;q_t&space;=&space;i))

**其中，`P(x_t|i)`表示在狀態i下生成觀測值`x_t`的機率，`x_t`表示在時間t的觀測值，`q_t`表示在時間t的狀態。**













